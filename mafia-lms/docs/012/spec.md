# Use Case: 운영 관리 (Operator)

## Primary Actor
- Operator (운영자)

## Precondition
- 운영자 권한(`role=operator`)으로 로그인되어 있음
- 운영 관리 페이지에 접근 가능

## Trigger
- 운영자가 신고 처리 또는 메타데이터 관리가 필요한 경우

---

## Main Scenario

### 1. 신고 접수 및 처리

**입력**
- 신고 대상 선택 (코스/과제/제출물/사용자)
- 신고 사유 (부적절한 내용, 표절, 스팸, 기타)
- 신고 내용 (텍스트)

**처리**
1. 신고 접수 시 `status=received`로 기록
2. 운영자가 신고 상세 조회
3. 상태 변경:
   - `received` → `investigating` (조사 중)
   - `investigating` → `resolved` (처리 완료)
4. 처리 액션 선택:
   - 경고 발송
   - 제출물 무효화 (`submissions.invalidated=true`)
   - 계정 제한 (`users.status=suspended`)
   - 코스/과제 비공개 처리

**출력**
- 신고 처리 결과 및 이력 기록
- 대상 사용자에게 알림 발송 (선택)

### 2. 메타데이터 관리

**입력**
- 카테고리 추가/수정/비활성화
- 난이도 추가/수정/비활성화

**처리**
1. 메타데이터 CRUD 수행
2. 사용 중인 값은 삭제 불가, 비활성화만 가능
3. 비활성화된 값은 신규 생성 시 선택 불가

**출력**
- 메타데이터 목록 갱신
- 기존 데이터에 영향 없음 (참조 무결성 유지)

---

## Edge Cases

### 신고 처리
- 이미 처리된 신고 재처리 시도 → 경고 메시지 표시
- 잘못된 신고 대상 ID → 404 오류
- 권한 없는 사용자 접근 → 403 Forbidden

### 메타데이터 관리
- 사용 중인 카테고리/난이도 삭제 시도 → 삭제 차단, 비활성화 안내
- 중복된 이름으로 생성 시도 → 유효성 검증 실패
- 빈 값 또는 너무 긴 텍스트 → 입력 검증 오류

### 액션 실행
- 이미 제한된 계정에 재제한 시도 → 현재 상태 표시
- 삭제된 제출물 무효화 시도 → 404 오류

---

## Business Rules

### 신고 처리
- 신고는 `received` → `investigating` → `resolved` 순서로만 진행
- 처리 완료된 신고는 상태 변경 불가 (읽기 전용)
- 모든 액션은 감사 로그에 기록됨

### 메타데이터
- 사용 중인 메타데이터는 삭제 불가, 비활성화만 가능
- 비활성화된 값은 기존 데이터에서 유지되나 신규 선택 불가
- 카테고리/난이도는 고유한 이름을 가져야 함

### 권한
- `role=operator`만 접근 가능
- 모든 운영 작업은 로그 기록 필수
- 민감한 액션(계정 제한, 무효화)은 이유 입력 필수

### 알림
- 제출물 무효화/계정 제한 시 대상 사용자에게 알림
- 신고 결과는 신고자에게 선택적으로 통보 가능
