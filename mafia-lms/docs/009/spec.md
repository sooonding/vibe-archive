# Use Case: 과제 관리 (Instructor)

## Primary Actor
Instructor

## Precondition
- 사용자가 Instructor 역할로 로그인되어 있음
- 본인이 소유한 코스가 1개 이상 존재
- 코스 상세 또는 과제 관리 페이지에 접근한 상태

## Trigger
Instructor가 과제 생성/수정/상태 전환 버튼을 클릭

## Main Scenario

### 과제 생성
1. Instructor가 코스 상세 페이지에서 "과제 추가" 버튼 클릭
2. 시스템이 과제 생성 폼 표시
3. Instructor가 과제 정보 입력
   - 제목 (필수)
   - 설명 (필수)
   - 마감일 (필수)
   - 점수 비중 (필수, 0~100)
   - 지각 허용 여부 (boolean)
   - 재제출 허용 여부 (boolean)
4. Instructor가 "저장" 버튼 클릭
5. 시스템이 입력값 검증
6. 시스템이 `status=draft`로 과제 생성
7. 시스템이 과제 목록 갱신 및 성공 메시지 표시

### 과제 수정
1. Instructor가 과제 목록에서 과제 선택
2. 시스템이 과제 수정 폼 표시 (기존 정보 로드)
3. Instructor가 과제 정보 수정
4. Instructor가 "저장" 버튼 클릭
5. 시스템이 입력값 검증
6. 시스템이 과제 정보 업데이트
7. 시스템이 과제 목록 갱신 및 성공 메시지 표시

### 과제 게시 (draft → published)
1. Instructor가 draft 상태 과제의 "게시" 버튼 클릭
2. 시스템이 게시 확인 모달 표시
3. Instructor가 "확인" 클릭
4. 시스템이 `status=published`로 변경
5. 시스템이 수강생에게 과제 노출
6. 시스템이 성공 메시지 표시

### 과제 마감 (published → closed)
1. Instructor가 published 상태 과제의 "마감" 버튼 클릭
2. 시스템이 마감 확인 모달 표시
3. Instructor가 "확인" 클릭
4. 시스템이 `status=closed`로 변경
5. 시스템이 수강생의 제출 버튼 비활성화
6. 시스템이 성공 메시지 표시

### 제출물 목록 조회
1. Instructor가 과제 상세 페이지에서 "제출물 목록" 탭 클릭
2. 시스템이 제출물 목록 표시
   - 학습자 이름
   - 제출 상태 (미제출/제출완료/채점완료/재제출필요)
   - 제출일시
   - 지각 여부
   - 점수 (채점된 경우)
3. Instructor가 필터 적용 가능
   - 미채점만 보기
   - 지각 제출만 보기
   - 재제출 요청만 보기

## Edge Cases
- **제목 미입력**: "제목을 입력해주세요" 에러 표시
- **설명 미입력**: "설명을 입력해주세요" 에러 표시
- **마감일 미입력**: "마감일을 선택해주세요" 에러 표시
- **점수 비중 범위 오류**: "점수 비중은 0~100 사이여야 합니다" 에러 표시
- **타인의 코스 과제 접근**: "권한이 없습니다" 에러 및 접근 차단
- **이미 게시된 과제 게시 시도**: "이미 게시된 과제입니다" 에러 표시
- **이미 마감된 과제 마감 시도**: "이미 마감된 과제입니다" 에러 표시
- **제출물이 있는 과제 삭제 시도**: "제출물이 있는 과제는 삭제할 수 없습니다" 경고 및 차단
- **과거 날짜로 마감일 설정**: "마감일은 현재 시각 이후여야 합니다" 경고 표시 (허용은 하되 경고)
- **네트워크 오류**: "작업에 실패했습니다. 다시 시도해주세요" 에러 표시

## Business Rules

### 과제 생성 정책
- Instructor는 자신이 소유한 코스에만 과제 생성 가능
- 신규 과제는 `status=draft`로 생성
- 제목, 설명, 마감일, 점수 비중은 필수 입력
- 점수 비중은 0~100 범위
- 지각 허용 여부 기본값: `false`
- 재제출 허용 여부 기본값: `false`

### 과제 수정 정책
- Instructor는 자신이 소유한 코스의 과제만 수정 가능
- 모든 상태(draft/published/closed)에서 수정 가능
- 단, published 상태 이후에는 마감일 연장만 권장 (단축은 학습자에게 불리)

### 과제 게시 정책
- draft 상태 과제만 게시 가능
- 게시 시 `status=published`로 변경
- 게시 즉시 수강생에게 노출
- 게시 후 draft로 되돌릴 수 없음

### 과제 마감 정책
- published 상태 과제만 수동 마감 가능
- 마감일 이후 자동으로 `status=closed`로 변경 (시스템 스케줄러)
- 마감 시 수강생 제출 버튼 비활성화
- 마감 후에도 채점은 가능
- 마감 후 published로 되돌릴 수 없음

### 과제 삭제 정책
- draft 상태 과제만 삭제 가능
- published 또는 closed 상태 과제는 삭제 불가
- 제출물이 1개라도 있으면 삭제 불가

### 제출물 목록 정책
- Instructor는 자신이 소유한 코스의 과제 제출물만 조회 가능
- 수강생별로 최신 제출물만 표시
- 필터 옵션:
  - 미채점: `status=submitted`
  - 지각 제출: `late=true`
  - 재제출 요청: `status=resubmission_required`
- 정렬 옵션:
  - 제출일시 기준 최신순/오래된순
  - 점수 기준 높은순/낮은순 (채점된 제출물만)

### 권한 검증
- 모든 과제 관리 기능은 Instructor 역할만 접근 가능
- Instructor는 본인이 소유한 코스의 과제만 관리 가능
- Learner는 과제 관리 페이지 접근 차단
