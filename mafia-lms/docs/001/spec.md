# Use Case 001: 홈/카탈로그 & 역할 선택 & 온보딩

## Primary Actor
- 미로그인 사용자 (홈 접근)
- 신규 사용자 (회원가입)

## Precondition
- 사용자가 홈 페이지 또는 회원가입 페이지에 접근
- 유효한 이메일 주소 보유 (회원가입 시)
- 약관 내용을 확인할 수 있는 상태 (회원가입 시)

## Trigger
- 사용자가 홈 페이지 접근 (비로그인 상태)
- 사용자가 "회원가입" 버튼 클릭

## Main Scenario

### 홈/카탈로그 접근 (비로그인)
1. 미로그인 사용자가 홈 페이지 접근
2. 시스템이 공개 코스 목록(카탈로그) 표시
3. 시스템이 로그인/회원가입 버튼 노출
4. 사용자가 코스 상세 클릭 시 로그인 페이지로 리다이렉트

### 회원가입 & 온보딩
1. 사용자가 이메일/비밀번호 입력
2. 사용자가 역할 선택 (Learner / Instructor)
3. 사용자가 프로필 정보 입력
   - 이름 (필수)
   - 휴대폰번호 (필수)
4. 사용자가 약관 확인 및 동의 체크
5. 시스템이 입력값 검증
6. 시스템이 Supabase Auth 계정 생성
7. 시스템이 `users` 테이블에 역할 저장
8. 시스템이 `profiles` 테이블에 프로필 생성
9. 시스템이 `terms_acceptance` 테이블에 동의 이력 저장
10. 시스템이 인증 토큰 발급
11. 시스템이 역할별 첫 화면으로 리다이렉트
    - Learner → 코스 카탈로그
    - Instructor → 대시보드

## Edge Cases

| 상황 | 처리 |
|------|------|
| 이메일 중복 | "이미 사용 중인 이메일입니다" 오류 표시 |
| 비밀번호 형식 오류 | "비밀번호는 최소 8자 이상이어야 합니다" 오류 표시 |
| 필수 입력값 누락 | 해당 필드에 "필수 항목입니다" 오류 표시 |
| 휴대폰번호 형식 오류 | "올바른 휴대폰번호 형식이 아닙니다" 오류 표시 |
| 약관 미동의 | "약관에 동의해야 가입할 수 있습니다" 오류 표시 |
| 네트워크 오류 | "잠시 후 다시 시도해주세요" 오류 표시 |
| DB 저장 실패 | 트랜잭션 롤백, "회원가입에 실패했습니다" 오류 표시 |

## Business Rules

### 입력 검증
- 이메일: 유효한 이메일 형식, 중복 불가
- 비밀번호: 최소 8자 이상
- 이름: 1자 이상
- 휴대폰번호: 숫자만 입력, 10~11자리
- 역할: `learner` 또는 `instructor` 중 하나만 선택

### 데이터 저장
- Auth 계정 생성 실패 시 전체 프로세스 중단
- `users`, `profiles`, `terms_acceptance` 생성은 트랜잭션으로 처리
- 일부 테이블 저장 실패 시 전체 롤백

### 약관 동의
- 약관 동의는 필수
- 동의 시점 타임스탬프 기록

### 홈 접근 (비로그인)
- 공개 코스 목록(status='published')만 카탈로그에 표시
- 코스 상세 페이지는 로그인 필요
- 로그인/회원가입 버튼 노출

### 리다이렉션
- 역할에 따라 초기 진입 화면 분기
  - Learner → `/courses` (코스 카탈로그)
  - Instructor → `/dashboard` (대시보드)
