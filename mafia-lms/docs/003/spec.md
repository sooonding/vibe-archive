# Use Case 003: Learner 대시보드

## Primary Actor
- Learner (학습자)

## Precondition
- 사용자가 Learner 역할로 로그인되어 있음
- 사용자가 최소 1개 이상의 코스에 수강신청한 상태 (신청 이력이 없는 경우 빈 화면 표시)

## Trigger
- 사용자가 대시보드 페이지(`/dashboard`)에 접근

## Main Scenario

### 1. 대시보드 접근
1. 사용자가 대시보드 링크를 클릭하거나 URL로 직접 접근
2. 시스템은 사용자 인증 상태 확인
3. 시스템은 사용자의 역할이 Learner인지 확인
4. 시스템은 대시보드 데이터를 로드하여 표시

### 2. 내 코스 목록 표시
1. 시스템은 사용자가 수강신청한 코스 목록을 조회 (`enrollments` 테이블 기준)
2. 각 코스에 대해 다음 정보를 표시:
   - 코스 제목, 카테고리, 난이도
   - 강사 이름
   - 수강신청일

### 3. 진행률 계산 및 표시
1. 시스템은 각 코스별로 과제 진행률을 계산:
   - 전체 과제 수 = 해당 코스의 `published` 상태 Assignment 개수
   - 완료 과제 수 = 본인이 제출한 Assignment 개수 (`submissions` 테이블, `status != 'resubmission_required'`)
   - 진행률 = (완료 과제 수 / 전체 과제 수) × 100%
2. 각 코스 카드에 진행률 표시 (예: 진행률 바, 퍼센트)

### 4. 마감 임박 과제 표시
1. 시스템은 다음 조건을 만족하는 과제 목록을 조회:
   - 사용자가 수강신청한 코스의 과제
   - Assignment 상태가 `published`
   - 마감일(`due_date`)이 현재 시각 기준 7일 이내
   - 아직 제출하지 않았거나 재제출 요청 상태인 과제
2. 마감일 기준 오름차순으로 정렬하여 표시
3. 각 과제에 대해 다음 정보 표시:
   - 과제 제목
   - 소속 코스 이름
   - 마감일 (상대 시간 표시: "2일 후", "3시간 후" 등)
   - 제출 상태 (미제출/재제출 필요)

### 5. 최근 피드백 표시
1. 시스템은 다음 조건을 만족하는 제출물을 조회:
   - 본인의 제출물
   - 채점 완료 상태 (`status = 'graded'` 또는 `status = 'resubmission_required'`)
   - 피드백이 존재하는 제출물
2. 피드백 작성일 기준 내림차순으로 정렬하여 최대 5개 표시
3. 각 피드백에 대해 다음 정보 표시:
   - 과제 제목
   - 소속 코스 이름
   - 점수 (채점 완료인 경우)
   - 피드백 내용 (일부 또는 전체)
   - 피드백 작성일
   - 재제출 요청 여부

## Edge Cases

### 1. 수강신청한 코스가 없는 경우
- 빈 상태 메시지 표시: "수강신청한 코스가 없습니다. 코스 카탈로그에서 코스를 둘러보세요."
- 코스 카탈로그 페이지로 이동하는 버튼 제공

### 2. 과제가 없는 코스
- 진행률 표시 영역에 "아직 과제가 없습니다" 또는 "0/0 완료" 표시
- 진행률 바는 0% 또는 비활성 상태로 표시

### 3. 마감 임박 과제가 없는 경우
- 빈 상태 메시지 표시: "마감 임박한 과제가 없습니다."

### 4. 피드백이 없는 경우
- 빈 상태 메시지 표시: "아직 받은 피드백이 없습니다."

### 5. 데이터 로딩 실패
- 각 섹션별로 에러 메시지 표시
- 재시도 버튼 제공
- 로딩 중 스켈레톤 UI 표시

### 6. 비로그인 사용자 접근
- 로그인 페이지로 리다이렉트
- 로그인 후 대시보드로 돌아올 수 있도록 redirect URL 전달

### 7. Instructor 역할 사용자 접근
- Instructor 대시보드(`/dashboard/instructor`)로 리다이렉트
- 또는 "Learner 전용 페이지입니다" 메시지와 함께 접근 차단

## Business Rules

### 진행률 계산 규칙
- 진행률은 `published` 상태의 Assignment만 집계
- 제출 상태가 `resubmission_required`인 경우 미완료로 간주
- 제출 상태가 `submitted` 또는 `graded`인 경우 완료로 간주
- 과제가 없는 코스는 진행률 0% 또는 "N/A" 표시

### 마감 임박 기준
- 마감일 기준 7일(168시간) 이내
- 이미 마감된 과제(`closed` 상태)는 제외
- 본인이 이미 제출 완료한 과제는 제외 (단, 재제출 요청 상태는 포함)

### 피드백 표시 규칙
- 최신 피드백 5개만 표시
- 피드백 내용이 길 경우 일정 길이로 자르고 "더보기" 링크 제공
- 피드백 작성일은 상대 시간으로 표시 ("1시간 전", "2일 전" 등)

### 데이터 갱신
- 페이지 접근 시마다 최신 데이터 조회
- 실시간 업데이트는 지원하지 않음 (새로고침 필요)

### 권한 제어
- Learner 역할만 접근 가능
- 본인이 수강신청한 코스의 데이터만 조회 가능
- 다른 학습자의 제출물, 피드백은 조회 불가
